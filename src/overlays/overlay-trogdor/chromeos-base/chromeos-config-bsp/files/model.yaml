# Copyright 2019 The ChromiumOS Authors
#
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

camera_config_ufc: &camera_config_ufc
  camera:
    count: 1
    devices:
      - interface: "{{$ufc-interface}}"
        facing: "front"
        orientation: 0
        flags:
          support-autofocus : "{{$ufc-autofocus}}"
          support-1080p: "{{$ufc-1080p}}"

camera_config_ufc_wfc: &camera_config_ufc_wfc
  camera:
    count: 2
    devices:
      - interface: "{{$ufc-interface}}"
        facing: "front"
        orientation: 0
        flags:
          support-autofocus : "{{$ufc-autofocus}}"
          support-1080p: "{{$ufc-1080p}}"
      - interface: "{{$wfc-interface}}"
        facing: "back"
        orientation: 0
        flags:
          support-autofocus : "{{$wfc-autofocus}}"
          support-1080p: "{{$wfc-1080p}}"

audio_config: &audio_config
  $cras_root: "/etc/cras"
  $ucm_root: "/usr/share/alsa/ucm"
  $cras-source: "{{cras-config-dir}}/audio/cras-config"
  $cras-dest: "{{$cras_root}}/{{cras-config-dir}}"
  $ucm-source: "{{cras-config-dir}}/audio/ucm-config"
  $ucm-dest: "{{$ucm_root}}/{{$card}}.{{ucm-suffix}}"
  main:
    cras-config-dir: "{{$device-name}}"
    ucm-suffix: "{{$device-name}}"
    files:
      - source: "{{$cras-source}}/{{$card}}"
        destination: "{{$cras-dest}}/{{$card}}"
      - source: "{{$cras-source}}/dsp.ini"
        destination: "{{$cras-dest}}/dsp.ini"
      - source: "{{$ucm-source}}/{{$card}}/HiFi.conf"
        destination: "{{$ucm-dest}}/HiFi.conf"
      - source: "{{$ucm-source}}/{{$card}}/{{$card}}.conf"
        destination: "{{$ucm-dest}}/{{$card}}.{{ucm-suffix}}.conf"

base-config: &base_config
  name: "{{$device-name}}"
  identity: &identity_common
    platform-name: "Trogdor"
    frid: "{{$fw-name}}"
    sku-id: "{{$sku-id}}"
  ui:
    help-content-id: "{{$help-content-id}}"
  firmware: &firmware_common
    build-targets: &firmware_build_targets_common
      bmpblk: "trogdor"
      coreboot: "{{$coreboot-build-name}}"
      ec: "{{$ec-build-name}}"
      depthcharge: "trogdor"
      libpayload: "trogdor"
  test-label: "{{$device-name}}"
  power: &power_common
    low-battery-shutdown-percent: "4.0"
    $has-keyboard-backlight: "0"
    has-keyboard-backlight: "{{$has-keyboard-backlight}}"
    $internal-backlight-no-als-battery-brightness: "63"
    internal-backlight-no-als-battery-brightness: "{{$internal-backlight-no-als-battery-brightness}}"
    internal-backlight-no-als-ac-brightness: "80"
    disable-dark-resume: "0"
    $set-cellular-transmit-power-for-tablet-mode: "0"
    set-cellular-transmit-power-for-tablet-mode: "{{$set-cellular-transmit-power-for-tablet-mode}}"
    $set-cellular-transmit-power-for-proximity: "0"
    set-cellular-transmit-power-for-proximity: "{{$set-cellular-transmit-power-for-proximity}}"
    $use-modemmanager-for-dynamic-sar: "0"
    use-modemmanager-for-dynamic-sar: "{{$use-modemmanager-for-dynamic-sar}}"
    $use-multi-power-level-dynamic-sar: "0"
    use-multi-power-level-dynamic-sar: "{{$use-multi-power-level-dynamic-sar}}"
    $set-cellular-transmit-power-level-mapping: ""
    set-cellular-transmit-power-level-mapping: "{{$set-cellular-transmit-power-level-mapping}}"
    suspend-to-idle: "1"
    wake-on-dp: "1"
  audio: *audio_config
  scheduler-tune:
    boost-urgent: 60
    boost-top-app: 60
    boost-arcvm: 0.82

zephyr-firmware-common: &zephyr_firmware_common
  <<: *firmware_common
  build-targets:
    <<: *firmware_build_targets_common
    zephyr-ec: "{{$ec-build-name}}"

convertible-config: &convertible_config
  <<: *base_config
  hardware-properties:
    form-factor: CHROMEBOOK
    psu-type: battery
    is-lid-convertible: True
    has-lid-accelerometer: True
    has-base-accelerometer: True
    has-base-gyroscope: True
    has-lid-magnetometer: False
    has-base-magnetometer: False
    has-touchscreen: True

clamshell-config: &clamshell_config
  <<: *base_config
  hardware-properties:
    form-factor: CHROMEBOOK
    psu-type: battery
    is-lid-convertible: False
    has-lid-accelerometer: False
    has-base-accelerometer: False
    has-base-gyroscope: False
    has-lid-magnetometer: False
    has-base-magnetometer: False
    $has-touchscreen: False
    has-touchscreen: "{{$has-touchscreen}}"

pazquel-config: &pazquel_config
  <<: *clamshell_config
  identity:
    <<: *identity_common
    custom-label-tag: "{{$custom-label-tag}}"

pazquel360-config: &pazquel360_config
  <<: *convertible_config
  identity:
    <<: *identity_common
    custom-label-tag: "{{$custom-label-tag}}"

p-sensor-20mm-lazor-config: &p_sensor_20mm_lazor_config
  $set-cellular-transmit-power-for-proximity: "1"
  proximity-sensor:
    semtech-config:
      - file:
          build-path: "lazor/proximity-sensor/lazor/semtech_config_cellular.json"
          system-path: "/usr/share/chromeos-assets/proximity-sensor/lazor/semtech_config_cellular.json"
        location: "cellular"

p-sensor-pazquel-config: &p_sensor_pazquel_config
  $set-cellular-transmit-power-for-proximity: "1"
  proximity-sensor:
    semtech-config:
      - file:
          build-path: "pazquel/proximity-sensor/pazquel/semtech_config_cellular.json"
          system-path: "/usr/share/chromeos-assets/proximity-sensor/pazquel/semtech_config_cellular.json"
        location: "cellular"

chromeos:
  devices:
    - $device-name: "trogdor"
      $fw-name: "Google_Trogdor"
      $coreboot-build-name: "trogdor"
      $ec-build-name: "trogdor"
      $help-content-id: "TROGDOR"
      $card: "sc7180-rt5682-max98357a-1mic"
      $ufc-interface: "usb"
      $ufc-autofocus: True
      $ufc-1080p: False
      skus:
        - $sku-id: 0 # LTE+Wifi
          config:
            <<: [ *convertible_config, *camera_config_ufc ]
            modem:
              firmware-variant: "{{$device-name}}"
        - $sku-id: 1 # Wifi-only
          config:
            <<: [ *convertible_config, *camera_config_ufc ]
    - $device-name: "kingoftown"
      $fw-name: "Google_Kingoftown"
      $coreboot-build-name: "kingoftown"
      $ec-build-name: "kingoftown"
      $help-content-id: "KINGOFTOWN"
      $card: "sc7180-rt5682s-max98357a-1mic"
      $ufc-interface: "usb"
      $ufc-autofocus: True
      $ufc-1080p: False
      skus:
        - $sku-id: 0 # LTE+Wifi+non-Touch+PS8640
          $has-touchscreen: False
          config:
            <<: [ *clamshell_config, *camera_config_ufc ]
            modem:
              firmware-variant: "{{$device-name}}"
        - $sku-id: 2 # LTE+Wifi+Touch+PS8640
          $has-touchscreen: True
          config:
            <<: [ *clamshell_config, *camera_config_ufc ]
            modem:
              firmware-variant: "{{$device-name}}"
        - $sku-id: 4 # LTE+Wifi+non-Touch+Ti-sn65
          $has-touchscreen: False
          config:
            <<: [ *clamshell_config, *camera_config_ufc ]
            modem:
              firmware-variant: "{{$device-name}}"
    - $device-name: "lazor"
      $fw-name: "Google_Lazor"
      $coreboot-build-name: "lazor"
      $ec-build-name: "lazor"
      $help-content-id: "LAZOR"
      $internal-backlight-no-als-battery-brightness: "43"
      $card: "sc7180-rt5682-max98357a-1mic"
      $ufc-interface: "usb"
      $ufc-autofocus: True
      $ufc-1080p: False
      skus:
        - $sku-id: 0 # LTE+Wifi
          $set-cellular-transmit-power-for-tablet-mode: "1"
          $use-modemmanager-for-dynamic-sar: "1"
          $use-multi-power-level-dynamic-sar: "1"
          $set-cellular-transmit-power-level-mapping: |
            HIGH 1
            MEDIUM 2
            LOW 3
          $has-keyboard-backlight: "1"
          config:
            <<: [ *convertible_config, *p_sensor_20mm_lazor_config, *camera_config_ufc ]
            modem:
              firmware-variant: "{{$device-name}}"
            firmware: *zephyr_firmware_common
        - $sku-id: 1 # Wifi-only
          config:
            <<: [ *convertible_config, *camera_config_ufc ]
            firmware: *zephyr_firmware_common
        - $sku-id: 2 # Wifi-only
          config:
            <<: [ *convertible_config, *camera_config_ufc ]
            firmware: *zephyr_firmware_common
          $has-keyboard-backlight: "1"
        - $sku-id: 10 # LTE+Wifi+No esim
          $set-cellular-transmit-power-for-tablet-mode: "1"
          $use-modemmanager-for-dynamic-sar: "1"
          $use-multi-power-level-dynamic-sar: "1"
          $set-cellular-transmit-power-level-mapping: |
            HIGH 1
            MEDIUM 2
            LOW 3
          $has-keyboard-backlight: "1"
          config:
            <<: [ *convertible_config, *p_sensor_20mm_lazor_config, *camera_config_ufc ]
            modem:
              firmware-variant: "{{$device-name}}"
            firmware: *zephyr_firmware_common
    - $device-name: "limozeen"
      $fw-name: "Google_Lazor"
      $coreboot-build-name: "lazor"
      $ec-build-name: "lazor"
      $help-content-id: "LIMOZEEN"
      $card: "sc7180-rt5682-max98357a-1mic"
      $ufc-interface: "usb"
      $ufc-autofocus: True
      $ufc-1080p: False
      skus:
        - $sku-id: 4 # LTE+Wifi+Touchscreen
          $has-touchscreen: True
          config:
            <<: [ *clamshell_config, *camera_config_ufc ]
            modem:
              firmware-variant: "{{$device-name}}"
            firmware: *zephyr_firmware_common
        - $sku-id: 5 # TODO(philipchen) Deprecate sku5 when no one uses it.
          config:
            <<: [ *clamshell_config, *camera_config_ufc ]
            modem:
              firmware-variant: "{{$device-name}}"
            firmware: *zephyr_firmware_common
        - $sku-id: 6 # LTE+Wifi+No Touchscreen
          config:
            <<: [ *clamshell_config, *camera_config_ufc ]
            modem:
              firmware-variant: "{{$device-name}}"
            firmware: *zephyr_firmware_common
        - $sku-id: 15 # LTE+Wifi+Touchscreen+No esim
          $has-touchscreen: True
          config:
            <<: [ *clamshell_config, *camera_config_ufc ]
            modem:
              firmware-variant: "{{$device-name}}"
            firmware: *zephyr_firmware_common
        - $sku-id: 18 # LTE+Wifi+No Touchscreen+No esim
          config:
            <<: [ *clamshell_config, *camera_config_ufc ]
            modem:
              firmware-variant: "{{$device-name}}"
            firmware: *zephyr_firmware_common
    - $device-name: "marzipan"
      $fw-name: "Google_Marzipan"
      $coreboot-build-name: "marzipan"
      $ec-build-name: "marzipan"
      $help-content-id: "MARZIPAN"
      $card: "sc7180-adau7002-max98357a"
      $ufc-interface: "usb"
      $ufc-autofocus: True
      $ufc-1080p: False
      skus:
        - $sku-id: 0
          $has-touchscreen: True
          config:
            <<: [ *convertible_config, *camera_config_ufc ]
    - $device-name: "pompom"
      $fw-name: "Google_Pompom"
      $coreboot-build-name: "pompom"
      $ec-build-name: "pompom"
      $help-content-id: "POMPOM"
      $ufc-interface: "usb"
      $ufc-autofocus: True
      $ufc-1080p: False
      $wfc-interface: "usb"
      $wfc-autofocus: True
      $wfc-1080p: True
      $card: "sc7180-rt5682-max98357a-2mic"
      skus:
        - $sku-id: 0 # LTE+Wifi
          config:
            <<: [ *convertible_config, *camera_config_ufc_wfc ]
            modem:
              firmware-variant: "{{$device-name}}"
        - $sku-id: 1 # Wifi-only
          config:
            <<: [ *convertible_config, *camera_config_ufc_wfc ]
    - $device-name: "pazquel"
      $fw-name: "Google_Pazquel"
      $coreboot-build-name: "pazquel"
      $ec-build-name: "pazquel"
      $card: "sc7180-rt5682-max98357a-1mic"
      $ufc-interface: "usb"
      $ufc-autofocus: True
      $ufc-1080p: False
      products:
        - $custom-label-tag: ""
          $help-content-id: "PAZQUEL"
        - $custom-label-tag: "orbic"
          $help-content-id: "PAZQUEL-ORBIC"
        - $custom-label-tag: "tsm"
          $help-content-id: "PAZQUEL-TSM"
      skus:
        - $sku-id: 0
          $use-modemmanager-for-dynamic-sar: "1"
          $set-cellular-transmit-power-level-mapping: |
            HIGH 1
            LOW 2
          config:
            <<: [ *pazquel_config, *camera_config_ufc, *p_sensor_pazquel_config ]
            modem:
              firmware-variant: "{{$device-name}}"
        - $sku-id: 1
          config:
            <<: [ *pazquel_config, *camera_config_ufc ]
        - $sku-id: 2
          $use-modemmanager-for-dynamic-sar: "1"
          $set-cellular-transmit-power-level-mapping: |
            HIGH 1
            LOW 2
          config:
            <<: [ *pazquel_config, *camera_config_ufc, *p_sensor_pazquel_config ]
            modem:
              firmware-variant: "{{$device-name}}"
        - $sku-id: 4
          $use-modemmanager-for-dynamic-sar: "1"
          $set-cellular-transmit-power-level-mapping: |
            HIGH 1
            LOW 2
          config:
            <<: [ *pazquel_config, *camera_config_ufc, *p_sensor_pazquel_config ]
            modem:
              firmware-variant: "{{$device-name}}"
        - $sku-id: 5
          config:
            <<: [ *pazquel_config, *camera_config_ufc ]
        - $sku-id: 6
          $use-modemmanager-for-dynamic-sar: "1"
          $set-cellular-transmit-power-level-mapping: |
            HIGH 1
            LOW 2
          config:
            <<: [ *pazquel_config, *camera_config_ufc, *p_sensor_pazquel_config ]
            modem:
              firmware-variant: "{{$device-name}}"
    - $device-name: "pazquel360"
      $fw-name: "Google_Pazquel"
      $coreboot-build-name: "pazquel"
      $ec-build-name: "pazquel"
      $card: "sc7180-rt5682s-max98357a-1mic"
      $ufc-interface: "usb"
      $ufc-autofocus: True
      $ufc-1080p: False
      products:
        - $custom-label-tag: ""
          $help-content-id: "PAZQUEL360"
        - $custom-label-tag: "prowise"
          $help-content-id: "PAZQUEL360-PROWISE"

      skus:
        - $sku-id: 20 # LTE+eSIM
          $use-modemmanager-for-dynamic-sar: "1"
          $set-cellular-transmit-power-level-mapping: |
            HIGH 1
            LOW 2
          config:
            <<: [ *pazquel360_config, *camera_config_ufc, *p_sensor_pazquel_config ]
            modem:
              firmware-variant: "{{$device-name}}"
        - $sku-id: 21 # WiFi
          config:
            <<: [ *pazquel360_config, *camera_config_ufc ]
        - $sku-id: 22 # LTE
          $use-modemmanager-for-dynamic-sar: "1"
          $set-cellular-transmit-power-level-mapping: |
            HIGH 1
            LOW 2
          config:
            <<: [ *pazquel360_config, *camera_config_ufc, *p_sensor_pazquel_config ]
            modem:
              firmware-variant: "{{$device-name}}"
